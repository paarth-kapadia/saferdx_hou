# SaferDx Scripts and Documentation

Paarth Kapadia, 2020-2021

SQL scripts for several differnt VA data projects, usually based
around the idea of an "e-trigger." In brief, find patients who have an
electronic medical record signal *suggestive* of (but not definitive
for) a problem with diagnostic quality.

# AHRQ-ML

Three triggers related to misdiagnosis in the ER setting

1. After ED discharge, return to hospital admission
2. After ED discharge, return to PCP, possibly with more severe dx.
3. Care escalation (such as wards to ICU)

# PCP triggers

PCP visit, followed by "something bad" happening in near future
(hospitalization, death).

# Utility scripts/data

- Dflt_pk_UTIL_EncounterTypeICD: exported CSVs of many "static" SQL
  tables (generally lists of ICD codes) used by multiple of these
  scripts.

- z_util/comorbidity_index_elix: SQL to calculate Elixhauser index,
  used by one or more of these other scripts.




# Moore Measures

One trigger to find patients whose initial presentation for a cancer
was in the emergency setting (e.g. lung cancer presenting to ED as
hemoptysis or pneumonia, colorectal cancer presenting as acute bowel
obstruction).




## Instructions for Moore

*Paarth email 2021-04-07*

Looking on the VINCI Database (under Singh2020), most of the tables seem to be colorectal cancer.  I generally test any new code I write on CRC and then change the ICD codes for lung to get the lung cancer info.  The other thing I’ve been doing is just re-running the script every time I need to pull data and then saving the results I want to save to the excel file sent to the chart reviewers.  This is all to ensure that the data being pulled is always up-to-date in terms of all the inclusion/exclusion criteria and code changes (so that there isn’t a CRC version of the script that has changes to the code that a Lung Cancer version of the script doesn’t have).  If you would like, I can do a data pull for today’s date and save it as “2021-04-07 CRC Data” or “2021-04-07 Lung Cancer Data” on SSMS, but so far I have not been doing that.  My general workflow has been:

1. Open up the script on VINCI

2. Uncomment out the cancer I want (I recently added prostate cancer to be a “control” cancer that doesn’t present as an emergency as often, as per UK literature; this was the first step in an analysis recommended by Dr. Lyratzopoulos and Dr. Abel but I don’t think we are chart reviewing the prostate cancer charts, just comparing what % emergency presentation the script returns for a cancer known to not often present as an emergency vs. those known to often present as emergencies)

    a. I’ve added comments delineating the start and end of the “CANCER SELECTION ZONE” on the code on VINCI (you can control F for this); will upload to the GitHub later today

3. Up until now, I’ve been copying and pasting the results directly from the SSMS printout into an excel file to send for chart reviews; however, I just added some code to save all the output in a table marked “OUTPUT_TABLE” (just a placeholder name that I can change depending on what you want the output table to be named).

    a. Regarding the excel file name mismatch: I originally made the excel template for CRC and forgot to change the headings to Lung Cancer (Dr. Jolly also brought this up and I thought I’d changed it at that time, but I guess I hadn’t or the changes were made to some other copy of the file).

4. Generally, the tables generated by the code are meant to be overridden as whenever I want to actually save the results, I manually save the printed out results as a table.
